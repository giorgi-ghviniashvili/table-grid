{"version":3,"file":"table-grid.min.js","sources":["../src/scripts/DataStore.js","../src/scripts/Table.js","../src/scripts/TableCompact.js"],"sourcesContent":["class DataStore {\n  constructor(data, pageSize = 10) {\n    this.all_data = data.slice(); // all rows\n    this.filtered_data = data.slice(); // filtered data\n\n    this.rows_shown = pageSize;\n    this.page_size = pageSize;\n  }\n\n  filter(fn) {\n    const truth = () => true;\n    this.filtered_data = this.all_data.filter(fn || truth);\n    return this.currentData;\n  }\n\n  sort(fn) {\n    this.filtered_data.sort((a, b) => {\n      return fn(a, b);\n    });\n    return this.currentData;\n  }\n\n  nextPage() {\n    this.rows_shown += this.page_size;\n    return this.currentData;\n  }\n\n  collapse() {\n    this.rows_shown = this.page_size;\n    return this.currentData;\n  }\n\n  set pageSize(size) {\n    this.page_size = size;\n    this.rows_shown = size;\n  }\n\n  get currentData() {\n    return this.filtered_data.slice(0, this.rows_shown);\n  }\n\n  get onlyOnePage() {\n    return this.filtered_data <= this.page_size;\n  }\n}\n\nexport default DataStore;","import { selection, select } from \"d3-selection\";\nimport { groups } from \"d3-array\";\nimport DataStore from \"./DataStore\";\n\nconst d3 = {selection, select, groups};\n\nconst getMobileBreakdown = () => {\n  const viewport = window.innerWidth;\n\n  if (viewport <= 576) {\n    return \"xs\";\n  } else if (viewport <= 768) {\n    return \"sm\";\n  } else if (viewport <= 992) {\n    return \"md\";\n  } else if (viewport <= 1200) {\n    return \"lg\";\n  } else {\n    return \"rest\";\n  }\n};\n\nfunction Table(params) {\n  init_patternify();\n\n  const attrs = Object.assign(\n    {\n      id: Math.floor(Math.random() * 10000000),\n      container: \"body\",\n      data: [], // all data\n      headers: [], // column configs\n      cellHeight: 60, // height of each cells in table body\n      firstColumnWidth: {\n        // city column width (varies based on screen size),\n        xs: 140,\n        sm: 130,\n        md: 145,\n        lg: 160,\n        rest: 175,\n      },\n      pageSize: {\n        // show\n        xs: 6,\n        sm: 10,\n        md: 10,\n        lg: 10,\n        rest: 12,\n      },\n      numOfColumnsMobile: {\n        xs: 2,\n        sm: 3,\n        md: 8,\n        lg: 10,\n        rest: 12,\n      },\n      mobileBreakdown: \"xs\",\n      pagination: true,\n      sortable: true,\n      responsive: true,\n    },\n    params\n  );\n\n  let store,\n    showMoreOrLessBtn,\n    eachWidth,\n    viewPortWidth,\n    container, // container div (d3 selection)\n    table, // table.choropleth div\n    headerCategories,\n    tableHeader, // header div\n    tableRow, // table rows (d3 selection)\n    tBody, // table body div\n    tableHeadCells, // table header cells (d3 selection)\n    transitionDuration = 1000, // how long should the transition take\n    headers = attrs.headers, // headers passed from main.js\n    categoryTitles = null,\n    showNColumnsMobile = 2, // how many columns to show on mobile scrollable horizontally;\n    currentSort = null, // current sort column\n    firstColumnWidth,\n    pageSize;\n\n  const getValue = (d, propName) => {\n    let prop = propName;\n    if (typeof propName === \"function\") {\n      prop = propName(d);\n    }\n    return d[prop];\n  };\n\n  function main() {\n    setDimensions();\n\n    store = new DataStore(attrs.data, pageSize);\n    container = d3.select(attrs.container);\n    currentSort = headers.find((d) => d.order);\n\n    categoryTitles = d3\n      .groups(\n        headers.filter((d) => d.category),\n        (d) => d.category\n      )\n      .map((d, i) => {\n        return {\n          title: d[0],\n          headers: d[1].length,\n          isMainColumn: d[1][0].isMainColumn,\n        };\n      });\n\n    table = container.patternify({\n      tag: \"div\",\n      selector: \"table-grid\",\n    });\n\n    headerCategories = table.patternify({\n      tag: \"div\",\n      selector: \"table-categories\",\n    });\n\n    tableHeader = table.patternify({\n      tag: \"div\",\n      selector: \"table-header\",\n    });\n\n    tBody = table\n      .patternify({\n        tag: \"div\",\n        selector: \"table-body\",\n      })\n      .style(\"position\", \"relative\");\n\n    drawAll();\n  }\n\n  function setDimensions() {\n    const br = getMobileBreakdown();\n\n    // if responsive and pagination are true, results blank columns\n    if (attrs.responsive && !attrs.pagination) {\n      attrs.responsive = false;\n    }\n\n    pageSize = attrs.pagination ? attrs.pageSize[br] : attrs.data.length + 1;\n    showNColumnsMobile = attrs.numOfColumnsMobile[br];\n    firstColumnWidth = attrs.firstColumnWidth[br];\n\n    if (store) {\n      store.pageSize = pageSize;\n    }\n  }\n\n  function drawAll(resize) {\n    if (attrs.pagination) {\n      showMoreOrLessBtn = container\n        .patternify({\n          tag: \"button\",\n          selector: \"show-btn\",\n        })\n        .attr(\"class\", \"show-btn btn\")\n        .text(\"SHOW MORE\")\n        .on(\"click\", function () {\n          if (store.currentData.length >= store.filtered_data.length) {\n            collapse();\n          } else {\n            showMore();\n          }\n        });\n\n      adjustShowBtn();\n    } else {\n      container.selectAll(\".show-btn\").remove();\n    }\n\n    table.classed(\"v-scrollable\", attrs.responsive);\n    tBody.classed(\"h-scrollable\", !attrs.pagination);\n\n    if (categoryTitles.length) {\n      addCategoryTitles();\n    }\n\n    addTableHead(resize);\n    addTableBody();\n\n    if (attrs.pagination) {\n      adjustHeight();\n    }\n\n    if (attrs.responsive) {\n      makeItResponsive();\n    }\n\n    if (attrs.sortable) {\n      if (currentSort) {\n        sortTableBy(currentSort, false);\n      }\n    }\n  }\n\n  function addCategoryTitles() {\n    if (!categoryTitles.some((d) => d.isMainColumn)) {\n      categoryTitles.unshift({\n        title: \"main\",\n        headers: 1,\n        isMainColumn: true,\n        hidden: true,\n      });\n    }\n\n    const catTitle = headerCategories\n      .patternify({\n        tag: \"div\",\n        selector: \"category-title\",\n        data: categoryTitles,\n      })\n      .html((d) => d.title)\n      .classed(\"main-column\", (d) => d.isMainColumn)\n      .style(\"width\", (d) => {\n        if (d.isMainColumn) {\n          return `${firstColumnWidth}px`;\n        }\n        return `calc(((100% - ${firstColumnWidth}px) / ${headers.length - 1}) * ${d.headers})`;\n      })\n      .style(\"visibility\", (d) => {\n        return d.hidden ? \"hidden\" : null;\n      });\n\n    catTitle.patternify({\n      tag: \"div\",\n      selector: \"cat-border\",\n    });\n  }\n\n  function addTableHead(resize) {\n    tableHeadCells = tableHeader\n      .patternify({\n        tag: \"div\",\n        selector: \"table-head\",\n        data: headers,\n      })\n      .attr(\"class\", (d, i) => {\n        return (\n          \"table-head\" +\n          (d.isMainColumn ? \" main-column\" : \"\") +\n          (d.class ? \" \" + d.class : \"\")\n        );\n      })\n      .style(\"width\", getWidth);\n\n    tableHeadCells.each(function (d) {\n      if (resize && d.isMainColumn) {\n        return;\n      }\n\n      if (d.headerTemplate && typeof d.headerTemplate === \"function\") {\n        d.headerTemplate(d).then((html) => {\n          d3.select(this).html(html);\n        });\n      } else {\n        d3.select(this).html(d.name);\n      }\n    });\n\n    // click events for the columns with has sort true\n    tableHeadCells\n      .filter((d) => d.sort)\n      .on(\"click\", (e, d) => {\n        if (d.order == \"asc\") {\n          d.order = \"desc\";\n        } else {\n          d.order = \"asc\";\n        }\n\n        sortTableBy(d);\n      });\n  }\n\n  function addTableBody() {\n    tableRow = tBody\n      .patternify({\n        tag: \"div\",\n        selector: \"table-row\",\n        data: store.currentData,\n      })\n      .style(\"left\", \"0px\")\n      .style(\"top\", function (d, i) {\n        return i * attrs.cellHeight + \"px\";\n      });\n\n    tableRow.each(function (d, i) {\n      const that = d3.select(this);\n\n      const tableData = that\n        .patternify({\n          tag: \"div\",\n          selector: \"table-data\",\n          data: headers,\n        })\n        .attr(\"class\", (d) => {\n          return (\n            \"table-data\" +\n            (d.isMainColumn ? \" main-column\" : \" value-column\") +\n            (d.class ? \" \" + d.class : \"\")\n          );\n        })\n        .style(\"width\", getWidth)\n        .style(\"height\", attrs.cellHeight + \"px\");\n\n      tableData\n        .patternify({\n          tag: \"div\",\n          selector: \"table-data-inner\",\n          data: (m) => [m],\n        })\n        .html((x) => {\n          if (x.cellTemplate && typeof x.cellTemplate === \"function\") {\n            return x.cellTemplate({\n              ...d,\n              value: getValue(d, x.propName),\n            });\n          }\n\n          return getValue(d, x.propName);\n        });\n    });\n  }\n\n  function sortTableBy(d, animate = true) {\n    if (!d.sort) return;\n\n    // first sort data\n    // store.sort((a, b) => d.sort(a, b, d.order));\n\n    // get first N rows and shuffle for transition\n    // data = shuffle(data.slice(0, numOfRows));\n\n    // redraw rows\n    // updateRows();\n\n    // grey out all icons and clear order property for other headers\n    tableHeadCells\n      .filter((d) => d.sort)\n      .each(function (x) {\n        const icon = d3.select(this);\n\n        if (x.id === d.id) {\n          icon.classed(\"active\", true);\n          icon.classed(x.order === \"asc\" ? \"desc\" : \"asc\", false);\n          icon.classed(x.order, true);\n        } else {\n          x.order = null;\n          icon.classed(\"active\", false);\n          icon.classed(\"desc\", false);\n          icon.classed(\"asc\", false);\n        }\n      });\n\n    // sorting table rows\n    tableRow\n      .sort((a, b) => d.sort(a, b, d.order))\n      .transition()\n      .duration(animate ? transitionDuration : 0)\n      .style(\"top\", (_, i) => {\n        return i * attrs.cellHeight + \"px\";\n      });\n\n    currentSort = d;\n  }\n\n  function getWidth(d) {\n    if (d.isMainColumn) {\n      return firstColumnWidth + \"px\";\n    }\n\n    return `calc((100% - ${firstColumnWidth}px) / ${headers.length - 1})`;\n  }\n\n  function adjustHeight() {\n    const tableHeaderHeight = tableHeader.node().getBoundingClientRect().height;\n\n    table.style(\n      \"height\",\n      tableHeaderHeight + 22 + attrs.cellHeight * store.currentData.length + \"px\"\n    );\n  }\n\n  function makeItResponsive() {\n    viewPortWidth = container.node().getBoundingClientRect().width;\n    eachWidth = (viewPortWidth - firstColumnWidth) / showNColumnsMobile;\n\n    const w = Math.max(\n      viewPortWidth,\n      eachWidth * (headers.length - 1) + firstColumnWidth\n    );\n\n    if (getMobileBreakdown() === attrs.mobileBreakdown && w > viewPortWidth) {\n      tBody.style(\"position\", \"static\");\n      table.classed(\"responsive\", true);\n\n      tableRow\n        .style(\"width\", w - firstColumnWidth + \"px\")\n        .style(\"position\", \"static\");\n\n      headerCategories.style(\"width\", w - firstColumnWidth + \"px\");\n\n      headerCategories.selectAll(\".category-title\").style(\"width\", (d, i) => {\n        if (d.isMainColumn) return firstColumnWidth + \"px\";\n        return `calc((100% / ${headers.length - 1}) * ${d.headers})`;\n      });\n\n      tableHeader.style(\"width\", w - firstColumnWidth + \"px\");\n\n      table\n        .selectAll(\".main-column\")\n        .style(\"position\", \"absolute\")\n        .style(\"margin-left\", -firstColumnWidth + \"px\");\n\n      table.style(\"margin-left\", firstColumnWidth + \"px\");\n\n      table\n        .selectAll(\".value-column\")\n        .style(\"width\", `calc(100% / ${headers.length - 1})`);\n\n      table.selectAll(\".table-head\").style(\"width\", (d, i) => {\n        if (d.isMainColumn) return firstColumnWidth + \"px\";\n        return `calc(100% / ${headers.length - 1})`;\n      });\n    } else {\n      table.classed(\"responsive\", false);\n      table\n        .selectAll(\".main-column\")\n        .style(\"position\", null)\n        .style(\"margin-left\", null);\n\n      table.selectAll(\".table-head\").style(\"width\", getWidth);\n\n      table\n        .selectAll(\".table-data\")\n        .style(\"width\", getWidth)\n        .style(\"height\", attrs.cellHeight + \"px\");\n\n      tBody.style(\"position\", \"relative\");\n      table.style(\"margin-left\", null);\n\n      tableRow\n        .style(\"width\", null)\n        .style(\"margin-left\", null)\n        .style(\"position\", null);\n\n      tableHeader.style(\"width\", null).style(\"margin-left\", null);\n\n      headerCategories.style(\"width\", null);\n\n      headerCategories.selectAll(\".category-title\").style(\"width\", (d) => {\n        if (d.isMainColumn) {\n          return `${firstColumnWidth}px`;\n        }\n        return `calc(((100% - ${firstColumnWidth}px) / ${\n          headers.length - 1\n        }) * ${d.headers})`;\n      });\n    }\n  }\n\n  function adjustShowBtn() {\n    if (store.onlyOnePage) {\n      showMoreOrLessBtn.style(\"display\", \"none\");\n    } else {\n      showMoreOrLessBtn.style(\"display\", null);\n\n      if (store.currentData.length >= store.filtered_data.length) {\n        showMoreOrLessBtn.text(\"SHOW LESS\");\n      } else {\n        showMoreOrLessBtn.text(\"SHOW MORE\");\n      }\n    }\n  }\n\n  function updateRows() {\n    table.classed(\"v-scrollable\", attrs.responsive);\n    tBody.classed(\"h-scrollable\", !attrs.pagination);\n\n    addTableBody();\n\n    if (attrs.pagination) {\n      adjustHeight();\n    }\n\n    if (attrs.responsive) {\n      makeItResponsive();\n    }\n  }\n\n  function showMore() {\n    store.nextPage();\n    adjustShowBtn();\n    updateRows();\n\n    if (currentSort && attrs.sortable) {\n      sortTableBy(currentSort, false);\n    }\n  }\n\n  function collapse() {\n    store.collapse();\n    adjustShowBtn();\n    updateRows();\n\n    if (currentSort && attrs.sortable) {\n      sortTableBy(currentSort, false);\n    }\n  }\n\n  main.filter = function (filterFunction) {\n    store.filter(filterFunction);\n\n    adjustShowBtn();\n    addTableBody();\n\n    if (attrs.pagination) {\n      adjustHeight();\n    }\n\n    if (currentSort && attrs.sortable) {\n      sortTableBy(currentSort, false);\n    }\n  };\n\n  main.render = function () {\n    main();\n\n    let tableWidth = window.innerWidth;\n\n    // window resize\n    d3.select(window).on(\"resize.\" + attrs.id, function () {\n      \n      if (tableWidth !== window.innerWidth) {\n        setDimensions();\n        drawAll(true);\n      }\n\n      tableWidth = window.innerWidth;\n    });\n    return main;\n  };\n\n  return main;\n}\n\nexport function init_patternify() {\n  d3.selection.prototype.patternify = function (params) {\n    var container = this;\n    var selector = params.selector;\n    var elementTag = params.tag;\n    var data = params.data || [selector];\n\n    // Pattern in action\n    var selection = container.selectAll(\".\" + selector).data(data, (d, i) => {\n      if (typeof d === \"object\") {\n        if (d.id) {\n          return d.id;\n        }\n      }\n      return i;\n    });\n    selection.exit().remove();\n    selection = selection.enter().append(elementTag).merge(selection);\n    selection.attr(\"class\", selector);\n    return selection;\n  };\n}\n\nexport default Table;","import { selection, select } from \"d3-selection\";\nimport { groups, sum } from \"d3-array\";\nimport DataStore from \"./DataStore\";\n\nconst d3 = {selection, select, groups, sum};\n\nclass TableCompact {\n  constructor(params) {\n    this.init_patternify();\n\n    this.attrs = Object.assign(\n      {\n        id: Math.floor(Math.random() * 10000000),\n        container: \"body\",\n        data: [],\n        headers: [],\n        cellHeight: 48,\n        rowsOnPage: 10,\n        pagination: true,\n        sortable: true,\n        rowGap: 4,\n        onResize: () => {},\n        rowTooltip: () => {},\n        onRowClick: () => {},\n      },\n      params\n    );\n\n    this.transitionDuration = 1000;\n    this.headers = this.attrs.headers;\n\n    this.main();\n    this.setResizeHandler();\n  }\n\n  main() {\n    const { attrs, headers } = this;\n\n    this.setDimensions();\n\n    this.store = new DataStore(attrs.data, this.pageSize);\n    this.container = d3.select(attrs.container);\n    this.currentSort = headers.find((d) => d.order);\n\n    this.table = this.container.patternify({\n      tag: \"div\",\n      selector: \"table-grid\",\n    });\n\n    this.tableHeader = this.table.patternify({\n      tag: \"div\",\n      selector: \"table-header\",\n    });\n\n    this.tBody = this.table\n      .patternify({\n        tag: \"div\",\n        selector: \"table-body\",\n      })\n      .style(\"position\", \"relative\")\n      .style(\"overflow-y\", attrs.pagination ? \"visible\" : null);\n\n    this.drawAll();\n  }\n\n  drawAll(resize) {\n    const { attrs, container } = this;\n\n    this.sumOfRatios = d3.sum(this.headers, (d) => d.widthRatio || 1);\n\n    if (attrs.pagination) {\n      this.showMoreOrLessBtn = container\n        .patternify({\n          tag: \"button\",\n          selector: \"show-btn\",\n        })\n        .attr(\"class\", \"show-btn btn\")\n        .text(\"SHOW MORE\")\n        .on(\"click\", () => {\n          if (\n            this.store.currentData.length >= this.store.filtered_data.length\n          ) {\n            this.collapse();\n          } else {\n            this.showMore();\n          }\n        });\n\n      this.adjustShowBtn();\n    } else {\n      container.selectAll(\".show-btn\").remove();\n    }\n\n    this.addTableHead(resize);\n    this.addTableBody();\n\n    if (attrs.pagination) {\n      this.adjustHeight();\n    }\n\n    if (attrs.sortable) {\n      if (this.currentSort) {\n        this.sortTableBy(this.currentSort, false);\n      }\n    }\n  }\n\n  addTableHead(resize) {\n    this.tableHeadCells = this.tableHeader\n      .patternify({\n        tag: \"div\",\n        selector: \"table-head\",\n        data: this.headers,\n      })\n      .attr(\"class\", (d, i) => {\n        return (\n          \"table-head\" +\n          (d.isMainColumn ? \" main-column\" : \"\") +\n          (d.class ? \" \" + d.class : \"\")\n        );\n      });\n\n    this.tableHeadCells.style(\"width\", (d) => this.getWidth(d));\n\n    this.tableHeadCells.each(function (d) {\n      if (resize && d.isMainColumn) {\n        return;\n      }\n\n      if (d.headerTemplate && typeof d.headerTemplate === \"function\") {\n        const tmplt = d.headerTemplate(d);\n\n        if (tmplt.then) {\n          tmplt.then((html) => {\n            d3.select(this).html(html);\n          });\n        } else {\n          d3.select(this).html(tmplt);\n        }\n      } else {\n        d3.select(this).html(d.name);\n      }\n\n      if (d.tooltip) {\n        if (this._tippy) {\n          this._tippy.destroy();\n        }\n\n        const html = typeof d.tooltip === \"function\" ? d.tooltip(d) : d.tooltip;\n\n        tippy(this, {\n          theme: \"light\",\n          content: html,\n          arrow: true,\n          allowHTML: true,\n          maxWidth: 220,\n          placement: \"top\",\n          onShow: () => window.innerWidth > 576,\n        });\n      }\n    });\n\n    // click events for the columns with has sort true\n    this.tableHeadCells\n      .filter((d) => d.sort)\n      .on(\"click\", (e, d) => {\n        if (this.attrs.sortable) {\n          if (d.order == \"asc\") {\n            d.order = \"desc\";\n          } else {\n            d.order = \"asc\";\n          }\n          this.sortTableBy(d);\n        }\n      });\n  }\n\n  addTableBody() {\n    const { headers, attrs } = this;\n    const self = this;\n\n    const tableRow = this.tBody\n      .patternify({\n        tag: \"div\",\n        selector: \"table-row\",\n        data: this.store.currentData,\n      })\n      .style(\"left\", \"0px\")\n      .style(\"top\", (d, i) => {\n        return i * (attrs.cellHeight + attrs.rowGap) + \"px\";\n      })\n      .on(\"click\", (e, d) => {\n        if (window.innerWidth <= 576) {\n          tableRow.classed(\"highlighted\", false);\n          d3.select(e.target).classed(\"highlighted\", true);\n          attrs.onRowClick(d);\n        }\n      });\n\n    tableRow.each(function (d, i) {\n      const that = d3.select(this);\n\n      const tableData = that\n        .patternify({\n          tag: \"div\",\n          selector: \"table-data\",\n          data: headers,\n        })\n        .attr(\"class\", (d) => {\n          return (\n            \"table-data\" +\n            (d.isMainColumn ? \" main-column\" : \" value-column\") +\n            (d.class ? \" \" + d.class : \"\")\n          );\n        })\n        .style(\"width\", (d) => self.getWidth(d))\n        .style(\"height\", attrs.cellHeight + \"px\");\n\n      tableData\n        .patternify({\n          tag: \"div\",\n          selector: \"table-data-inner\",\n          data: (m) => [m],\n        })\n        .html((x) => {\n          if (x.cellTemplate && typeof x.cellTemplate === \"function\") {\n            return x.cellTemplate(\n              {\n                ...d,\n                value: self.getValue(d, x.propName),\n              },\n              x\n            );\n          }\n\n          return self.getValue(d, x.propName);\n        });\n\n      const tooltipHtml = attrs.rowTooltip(d);\n\n      if (this._tippy) {\n        this._tippy.destroy();\n      }\n\n      tippy(this, {\n        theme: \"light\",\n        content: tooltipHtml,\n        arrow: true,\n        allowHTML: true,\n        maxWidth: 350,\n        trigger: \"click\",\n        placement: \"right\",\n        zIndex: 999999,\n        offset: [0, -318],\n        onHide: () => tableRow.classed(\"highlighted\", false),\n        onShow: () => {\n          if (window.innerWidth > 576) {\n            that.classed(\"highlighted\", true);\n            return true;\n          }\n          return false;\n        },\n      });\n    });\n\n    this.tableRow = tableRow;\n  }\n\n  sortTableBy(d, animate = true) {\n    if (!d.sort) return;\n\n    // grey out all icons and clear order property for other headers\n    this.tableHeadCells\n      .filter((d) => d.sort)\n      .each(function (x) {\n        const icon = d3.select(this);\n\n        if (x.id === d.id) {\n          icon.classed(\"active\", true);\n          icon.classed(x.order === \"asc\" ? \"desc\" : \"asc\", false);\n          icon.classed(x.order, true);\n        } else {\n          x.order = null;\n          icon.classed(\"active\", false);\n          icon.classed(\"desc\", false);\n          icon.classed(\"asc\", false);\n        }\n      });\n\n    // sorting table rows\n    this.tableRow\n      .sort((a, b) => d.sort(a, b, d.order))\n      .transition()\n      .duration(animate ? this.transitionDuration : 0)\n      .style(\"top\", (_, i) => {\n        return i * (this.attrs.cellHeight + this.attrs.rowGap) + \"px\";\n      });\n\n    this.currentSort = d;\n  }\n\n  getValue(d, propName) {\n    let prop = propName;\n    if (typeof propName === \"function\") {\n      prop = propName(d);\n    }\n    return d[prop];\n  }\n\n  setDimensions() {\n    this.pageSize = this.attrs.pagination\n      ? this.attrs.rowsOnPage\n      : this.attrs.data.length + 1;\n\n    if (this.store) {\n      this.store.pageSize = this.pageSize;\n    }\n  }\n\n  getWidth(d) {\n    const percent = (d.widthRatio || 1) / this.sumOfRatios;\n    return percent * 100 + \"%\";\n  }\n\n  adjustHeight() {\n    const tableHeaderHeight = this.tableHeader\n      .node()\n      .getBoundingClientRect().height;\n\n    const height =\n      tableHeaderHeight +\n      (this.attrs.cellHeight + this.attrs.rowGap) *\n        this.store.currentData.length;\n\n    this.table.style(\"height\", height + \"px\");\n    this.tBody.style(\"height\", height + \"px\");\n  }\n\n  adjustShowBtn() {\n    const { showMoreOrLessBtn, store } = this;\n    if (store.onlyOnePage) {\n      showMoreOrLessBtn.style(\"display\", \"none\");\n    } else {\n      showMoreOrLessBtn.style(\"display\", null);\n\n      if (store.currentData.length >= store.filtered_data.length) {\n        showMoreOrLessBtn.text(\"SHOW LESS\");\n      } else {\n        showMoreOrLessBtn.text(\"SHOW MORE\");\n      }\n    }\n  }\n\n  updateRows() {\n    this.addTableBody();\n\n    if (this.attrs.pagination) {\n      this.adjustHeight();\n    }\n  }\n\n  showMore() {\n    this.store.nextPage();\n    this.adjustShowBtn();\n    this.updateRows();\n\n    if (this.currentSort && this.attrs.sortable) {\n      this.sortTableBy(this.currentSort, false);\n    }\n  }\n\n  collapse() {\n    this.store.collapse();\n    this.adjustShowBtn();\n    this.updateRows();\n\n    if (this.currentSort && this.attrs.sortable) {\n      this.sortTableBy(this.currentSort, false);\n    }\n  }\n\n  filter(filterFunction) {\n    this.store.filter(filterFunction);\n\n    this.adjustShowBtn();\n    this.addTableBody();\n\n    if (this.attrs.pagination) {\n      this.adjustHeight();\n    }\n\n    if (this.currentSort && this.attrs.sortable) {\n      this.sortTableBy(this.currentSort, false);\n    }\n  }\n\n  showColumns(visibleHeaders) {\n    this.headers = visibleHeaders;\n    this.drawAll();\n  }\n\n  unhighlight() {\n    this.tableRow.classed(\"highlighted\", false);\n  }\n\n  setResizeHandler() {\n    let curWidth = window.innerWidth;\n\n    // window resize\n    d3.select(window).on(\"resize.\" + this.attrs.id, () => {\n      if (curWidth !== window.innerWidth) {\n        this.setDimensions();\n        this.drawAll(true);\n        this.attrs.onResize();\n      }\n      curWidth = window.innerWidth;\n    });\n  }\n\n  init_patternify() {\n    d3.selection.prototype.patternify = function (params) {\n      var container = this;\n      var selector = params.selector;\n      var elementTag = params.tag;\n      var data = params.data || [selector];\n  \n      // Pattern in action\n      var selection = container.selectAll(\".\" + selector).data(data, (d, i) => {\n        if (typeof d === \"object\") {\n          if (d.id) {\n            return d.id;\n          }\n        }\n        return i;\n      });\n      selection.exit().remove();\n      selection = selection.enter().append(elementTag).merge(selection);\n      selection.attr(\"class\", selector);\n      return selection;\n    };\n  }\n}\n\nexport default TableCompact;"],"names":["DataStore","constructor","data","pageSize","this","all_data","slice","filtered_data","rows_shown","page_size","filter","fn","currentData","sort","a","b","nextPage","collapse","size","onlyOnePage","d3","selection","select","groups","getMobileBreakdown","viewport","window","innerWidth","sum","params","prototype","patternify","container","selector","elementTag","tag","selectAll","d","i","id","exit","remove","enter","append","merge","attr","attrs","Object","assign","Math","floor","random","headers","cellHeight","firstColumnWidth","xs","sm","md","lg","rest","numOfColumnsMobile","mobileBreakdown","pagination","sortable","responsive","store","showMoreOrLessBtn","eachWidth","viewPortWidth","table","headerCategories","tableHeader","tableRow","tBody","tableHeadCells","categoryTitles","showNColumnsMobile","currentSort","getValue","propName","prop","main","setDimensions","find","order","category","map","title","length","isMainColumn","style","drawAll","br","resize","text","on","adjustShowBtn","updateRows","sortTableBy","classed","some","unshift","hidden","html","addCategoryTitles","class","getWidth","each","headerTemplate","then","name","e","addTableHead","addTableBody","adjustHeight","makeItResponsive","tableData","m","x","cellTemplate","value","animate","icon","transition","duration","_","tableHeaderHeight","node","getBoundingClientRect","height","width","w","max","filterFunction","render","tableWidth","init_patternify","rowsOnPage","rowGap","onResize","rowTooltip","onRowClick","transitionDuration","setResizeHandler","sumOfRatios","widthRatio","showMore","tmplt","tooltip","_tippy","destroy","tippy","theme","content","arrow","allowHTML","maxWidth","placement","onShow","self","target","that","tooltipHtml","trigger","zIndex","offset","onHide","showColumns","visibleHeaders","unhighlight","curWidth"],"mappings":"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"}